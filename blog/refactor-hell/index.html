<!DOCTYPE html><html lang="en"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="icon" href="/favicon.ico"/><title>Blog - Refactor Hell | zyrn</title><meta property="og:type" content="website"/><meta property="og:title" content="Blog - Refactor Hell"/><meta property="og:site_name" content="zyrn"/><meta name="robots" content="index, follow"/><meta name="next-head-count" content="8"/><link rel="preload" href="/_next/static/css/069ff64b07ed1af4.css" as="style"/><link rel="stylesheet" href="/_next/static/css/069ff64b07ed1af4.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-2bbe73903b6b5b3e.js" defer=""></script><script src="/_next/static/chunks/framework-beb51d85c0b60541.js" defer=""></script><script src="/_next/static/chunks/main-f259eebfd173a455.js" defer=""></script><script src="/_next/static/chunks/pages/_app-919c8d447b8a73d0.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bfilename%5D-32eee704f381dcf6.js" defer=""></script><script src="/_next/static/ivrcb-DN-mBRoThUjEOaE/_buildManifest.js" defer=""></script><script src="/_next/static/ivrcb-DN-mBRoThUjEOaE/_ssgManifest.js" defer=""></script><script src="/_next/static/ivrcb-DN-mBRoThUjEOaE/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><style data-emotion="css-global de17o9">:host,:root{--chakra-ring-inset:var(--chakra-empty,/*!*/ /*!*/);--chakra-ring-offset-width:0px;--chakra-ring-offset-color:#fff;--chakra-ring-color:rgba(66, 153, 225, 0.6);--chakra-ring-offset-shadow:0 0 #0000;--chakra-ring-shadow:0 0 #0000;--chakra-space-x-reverse:0;--chakra-space-y-reverse:0;--theme-colors-transparent:transparent;--theme-colors-current:currentColor;--theme-colors-black:#000000;--theme-colors-white:#FFFFFF;--theme-colors-whiteAlpha-50:rgba(255, 255, 255, 0.04);--theme-colors-whiteAlpha-100:rgba(255, 255, 255, 0.06);--theme-colors-whiteAlpha-200:rgba(255, 255, 255, 0.08);--theme-colors-whiteAlpha-300:rgba(255, 255, 255, 0.16);--theme-colors-whiteAlpha-400:rgba(255, 255, 255, 0.24);--theme-colors-whiteAlpha-500:rgba(255, 255, 255, 0.36);--theme-colors-whiteAlpha-600:rgba(255, 255, 255, 0.48);--theme-colors-whiteAlpha-700:rgba(255, 255, 255, 0.64);--theme-colors-whiteAlpha-800:rgba(255, 255, 255, 0.80);--theme-colors-whiteAlpha-900:rgba(255, 255, 255, 0.92);--theme-colors-blackAlpha-50:rgba(0, 0, 0, 0.04);--theme-colors-blackAlpha-100:rgba(0, 0, 0, 0.06);--theme-colors-blackAlpha-200:rgba(0, 0, 0, 0.08);--theme-colors-blackAlpha-300:rgba(0, 0, 0, 0.16);--theme-colors-blackAlpha-400:rgba(0, 0, 0, 0.24);--theme-colors-blackAlpha-500:rgba(0, 0, 0, 0.36);--theme-colors-blackAlpha-600:rgba(0, 0, 0, 0.48);--theme-colors-blackAlpha-700:rgba(0, 0, 0, 0.64);--theme-colors-blackAlpha-800:rgba(0, 0, 0, 0.80);--theme-colors-blackAlpha-900:rgba(0, 0, 0, 0.92);--theme-colors-gray-50:#F7FAFC;--theme-colors-gray-100:#EDF2F7;--theme-colors-gray-200:#E2E8F0;--theme-colors-gray-300:#CBD5E0;--theme-colors-gray-400:#A0AEC0;--theme-colors-gray-500:#718096;--theme-colors-gray-600:#4A5568;--theme-colors-gray-700:#2D3748;--theme-colors-gray-800:#1A202C;--theme-colors-gray-900:#171923;--theme-colors-red-50:#FFF5F5;--theme-colors-red-100:#FED7D7;--theme-colors-red-200:#FEB2B2;--theme-colors-red-300:#FC8181;--theme-colors-red-400:#F56565;--theme-colors-red-500:#E53E3E;--theme-colors-red-600:#C53030;--theme-colors-red-700:#9B2C2C;--theme-colors-red-800:#822727;--theme-colors-red-900:#63171B;--theme-colors-orange-50:#FFFAF0;--theme-colors-orange-100:#FEEBC8;--theme-colors-orange-200:#FBD38D;--theme-colors-orange-300:#F6AD55;--theme-colors-orange-400:#ED8936;--theme-colors-orange-500:#DD6B20;--theme-colors-orange-600:#C05621;--theme-colors-orange-700:#9C4221;--theme-colors-orange-800:#7B341E;--theme-colors-orange-900:#652B19;--theme-colors-yellow-50:#FFFFF0;--theme-colors-yellow-100:#FEFCBF;--theme-colors-yellow-200:#FAF089;--theme-colors-yellow-300:#F6E05E;--theme-colors-yellow-400:#ECC94B;--theme-colors-yellow-500:#D69E2E;--theme-colors-yellow-600:#B7791F;--theme-colors-yellow-700:#975A16;--theme-colors-yellow-800:#744210;--theme-colors-yellow-900:#5F370E;--theme-colors-green-50:#F0FFF4;--theme-colors-green-100:#C6F6D5;--theme-colors-green-200:#9AE6B4;--theme-colors-green-300:#68D391;--theme-colors-green-400:#48BB78;--theme-colors-green-500:#38A169;--theme-colors-green-600:#2F855A;--theme-colors-green-700:#276749;--theme-colors-green-800:#22543D;--theme-colors-green-900:#1C4532;--theme-colors-teal-50:#E6FFFA;--theme-colors-teal-100:#B2F5EA;--theme-colors-teal-200:#81E6D9;--theme-colors-teal-300:#4FD1C5;--theme-colors-teal-400:#38B2AC;--theme-colors-teal-500:#319795;--theme-colors-teal-600:#2C7A7B;--theme-colors-teal-700:#285E61;--theme-colors-teal-800:#234E52;--theme-colors-teal-900:#1D4044;--theme-colors-blue-50:#ebf8ff;--theme-colors-blue-100:#bee3f8;--theme-colors-blue-200:#90cdf4;--theme-colors-blue-300:#63b3ed;--theme-colors-blue-400:#4299e1;--theme-colors-blue-500:#3182ce;--theme-colors-blue-600:#2b6cb0;--theme-colors-blue-700:#2c5282;--theme-colors-blue-800:#2a4365;--theme-colors-blue-900:#1A365D;--theme-colors-cyan-50:#EDFDFD;--theme-colors-cyan-100:#C4F1F9;--theme-colors-cyan-200:#9DECF9;--theme-colors-cyan-300:#76E4F7;--theme-colors-cyan-400:#0BC5EA;--theme-colors-cyan-500:#00B5D8;--theme-colors-cyan-600:#00A3C4;--theme-colors-cyan-700:#0987A0;--theme-colors-cyan-800:#086F83;--theme-colors-cyan-900:#065666;--theme-colors-purple-50:#FAF5FF;--theme-colors-purple-100:#E9D8FD;--theme-colors-purple-200:#D6BCFA;--theme-colors-purple-300:#B794F4;--theme-colors-purple-400:#9F7AEA;--theme-colors-purple-500:#805AD5;--theme-colors-purple-600:#6B46C1;--theme-colors-purple-700:#553C9A;--theme-colors-purple-800:#44337A;--theme-colors-purple-900:#322659;--theme-colors-pink-50:#FFF5F7;--theme-colors-pink-100:#FED7E2;--theme-colors-pink-200:#FBB6CE;--theme-colors-pink-300:#F687B3;--theme-colors-pink-400:#ED64A6;--theme-colors-pink-500:#D53F8C;--theme-colors-pink-600:#B83280;--theme-colors-pink-700:#97266D;--theme-colors-pink-800:#702459;--theme-colors-pink-900:#521B41;--theme-colors-linkedin-50:#E8F4F9;--theme-colors-linkedin-100:#CFEDFB;--theme-colors-linkedin-200:#9BDAF3;--theme-colors-linkedin-300:#68C7EC;--theme-colors-linkedin-400:#34B3E4;--theme-colors-linkedin-500:#00A0DC;--theme-colors-linkedin-600:#008CC9;--theme-colors-linkedin-700:#0077B5;--theme-colors-linkedin-800:#005E93;--theme-colors-linkedin-900:#004471;--theme-colors-facebook-50:#E8F4F9;--theme-colors-facebook-100:#D9DEE9;--theme-colors-facebook-200:#B7C2DA;--theme-colors-facebook-300:#6482C0;--theme-colors-facebook-400:#4267B2;--theme-colors-facebook-500:#385898;--theme-colors-facebook-600:#314E89;--theme-colors-facebook-700:#29487D;--theme-colors-facebook-800:#223B67;--theme-colors-facebook-900:#1E355B;--theme-colors-messenger-50:#D0E6FF;--theme-colors-messenger-100:#B9DAFF;--theme-colors-messenger-200:#A2CDFF;--theme-colors-messenger-300:#7AB8FF;--theme-colors-messenger-400:#2E90FF;--theme-colors-messenger-500:#0078FF;--theme-colors-messenger-600:#0063D1;--theme-colors-messenger-700:#0052AC;--theme-colors-messenger-800:#003C7E;--theme-colors-messenger-900:#002C5C;--theme-colors-whatsapp-50:#dffeec;--theme-colors-whatsapp-100:#b9f5d0;--theme-colors-whatsapp-200:#90edb3;--theme-colors-whatsapp-300:#65e495;--theme-colors-whatsapp-400:#3cdd78;--theme-colors-whatsapp-500:#22c35e;--theme-colors-whatsapp-600:#179848;--theme-colors-whatsapp-700:#0c6c33;--theme-colors-whatsapp-800:#01421c;--theme-colors-whatsapp-900:#001803;--theme-colors-twitter-50:#E5F4FD;--theme-colors-twitter-100:#C8E9FB;--theme-colors-twitter-200:#A8DCFA;--theme-colors-twitter-300:#83CDF7;--theme-colors-twitter-400:#57BBF5;--theme-colors-twitter-500:#1DA1F2;--theme-colors-twitter-600:#1A94DA;--theme-colors-twitter-700:#1681BF;--theme-colors-twitter-800:#136B9E;--theme-colors-twitter-900:#0D4D71;--theme-colors-telegram-50:#E3F2F9;--theme-colors-telegram-100:#C5E4F3;--theme-colors-telegram-200:#A2D4EC;--theme-colors-telegram-300:#7AC1E4;--theme-colors-telegram-400:#47A9DA;--theme-colors-telegram-500:#0088CC;--theme-colors-telegram-600:#007AB8;--theme-colors-telegram-700:#006BA1;--theme-colors-telegram-800:#005885;--theme-colors-telegram-900:#003F5E;--theme-colors-light-base:#f8f8f2;--theme-colors-light-currentline:#44475a;--theme-colors-light-selection:#44475a;--theme-colors-light-foreground:#282a36;--theme-colors-light-comment:#6272a4;--theme-colors-light-cyan:hsl(191, 97%, 54%);--theme-colors-light-green:#50fa7b;--theme-colors-light-orange:#ffb86c;--theme-colors-light-pink:#ff79c6;--theme-colors-light-purple:#bd93f9;--theme-colors-light-red:#ff5555;--theme-colors-light-yellow:#f1fa8c;--theme-colors-dark-base:#282a36;--theme-colors-dark-currentline:#44475a;--theme-colors-dark-selection:#44475a;--theme-colors-dark-foreground:#f8f8f2;--theme-colors-dark-comment:#6272a4;--theme-colors-dark-cyan:#8be9fd;--theme-colors-dark-green:#50fa7b;--theme-colors-dark-orange:#ffb86c;--theme-colors-dark-pink:#ff79c6;--theme-colors-dark-purple:#bd93f9;--theme-colors-dark-red:#ff5555;--theme-colors-dark-yellow:#f1fa8c;--theme-colors-custom-50:hsl(240deg 11% 95%);--theme-colors-custom-100:hsl(240deg 11% 90%);--theme-colors-custom-200:hsl(240deg 11% 80%);--theme-colors-custom-300:hsl(240deg 11% 70%);--theme-colors-custom-400:hsl(240deg 11% 60%);--theme-colors-custom-500:hsl(240deg 11% 50%);--theme-colors-custom-600:hsl(240deg 11% 40%);--theme-colors-custom-700:hsl(240deg 11% 30%);--theme-colors-custom-800:hsl(240deg 11% 20%);--theme-colors-custom-900:hsl(240deg 11% 10%);--theme-borders-none:0;--theme-borders-1px:1px solid;--theme-borders-2px:2px solid;--theme-borders-4px:4px solid;--theme-borders-8px:8px solid;--theme-fonts-heading:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;--theme-fonts-body:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;--theme-fonts-mono:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;--theme-fontSizes-xs:0.75rem;--theme-fontSizes-sm:0.875rem;--theme-fontSizes-md:1rem;--theme-fontSizes-lg:1.125rem;--theme-fontSizes-xl:1.25rem;--theme-fontSizes-2xl:1.5rem;--theme-fontSizes-3xl:1.875rem;--theme-fontSizes-4xl:2.25rem;--theme-fontSizes-5xl:3rem;--theme-fontSizes-6xl:3.75rem;--theme-fontSizes-7xl:4.5rem;--theme-fontSizes-8xl:6rem;--theme-fontSizes-9xl:8rem;--theme-fontWeights-hairline:100;--theme-fontWeights-thin:200;--theme-fontWeights-light:300;--theme-fontWeights-normal:400;--theme-fontWeights-medium:500;--theme-fontWeights-semibold:600;--theme-fontWeights-bold:700;--theme-fontWeights-extrabold:800;--theme-fontWeights-black:900;--theme-letterSpacings-tighter:-0.05em;--theme-letterSpacings-tight:-0.025em;--theme-letterSpacings-normal:0;--theme-letterSpacings-wide:0.025em;--theme-letterSpacings-wider:0.05em;--theme-letterSpacings-widest:0.1em;--theme-lineHeights-3:.75rem;--theme-lineHeights-4:1rem;--theme-lineHeights-5:1.25rem;--theme-lineHeights-6:1.5rem;--theme-lineHeights-7:1.75rem;--theme-lineHeights-8:2rem;--theme-lineHeights-9:2.25rem;--theme-lineHeights-10:2.5rem;--theme-lineHeights-normal:normal;--theme-lineHeights-none:1;--theme-lineHeights-shorter:1.25;--theme-lineHeights-short:1.375;--theme-lineHeights-base:1.5;--theme-lineHeights-tall:1.625;--theme-lineHeights-taller:2;--theme-radii-none:0;--theme-radii-sm:0.125rem;--theme-radii-base:0.25rem;--theme-radii-md:0.375rem;--theme-radii-lg:0.5rem;--theme-radii-xl:0.75rem;--theme-radii-2xl:1rem;--theme-radii-3xl:1.5rem;--theme-radii-full:9999px;--theme-space-1:0.25rem;--theme-space-2:0.5rem;--theme-space-3:0.75rem;--theme-space-4:1rem;--theme-space-5:1.25rem;--theme-space-6:1.5rem;--theme-space-7:1.75rem;--theme-space-8:2rem;--theme-space-9:2.25rem;--theme-space-10:2.5rem;--theme-space-12:3rem;--theme-space-14:3.5rem;--theme-space-16:4rem;--theme-space-20:5rem;--theme-space-24:6rem;--theme-space-28:7rem;--theme-space-32:8rem;--theme-space-36:9rem;--theme-space-40:10rem;--theme-space-44:11rem;--theme-space-48:12rem;--theme-space-52:13rem;--theme-space-56:14rem;--theme-space-60:15rem;--theme-space-64:16rem;--theme-space-72:18rem;--theme-space-80:20rem;--theme-space-96:24rem;--theme-space-px:1px;--theme-space-0\.5:0.125rem;--theme-space-1\.5:0.375rem;--theme-space-2\.5:0.625rem;--theme-space-3\.5:0.875rem;--theme-shadows-xs:0 0 0 1px rgba(0, 0, 0, 0.05);--theme-shadows-sm:0 1px 2px 0 rgba(0, 0, 0, 0.05);--theme-shadows-base:0 1px 3px 0 rgba(0, 0, 0, 0.1),0 1px 2px 0 rgba(0, 0, 0, 0.06);--theme-shadows-md:0 4px 6px -1px rgba(0, 0, 0, 0.1),0 2px 4px -1px rgba(0, 0, 0, 0.06);--theme-shadows-lg:0 10px 15px -3px rgba(0, 0, 0, 0.1),0 4px 6px -2px rgba(0, 0, 0, 0.05);--theme-shadows-xl:0 20px 25px -5px rgba(0, 0, 0, 0.1),0 10px 10px -5px rgba(0, 0, 0, 0.04);--theme-shadows-2xl:0 25px 50px -12px rgba(0, 0, 0, 0.25);--theme-shadows-outline:0 0 0 3px rgba(66, 153, 225, 0.6);--theme-shadows-inner:inset 0 2px 4px 0 rgba(0,0,0,0.06);--theme-shadows-none:none;--theme-shadows-dark-lg:rgba(0, 0, 0, 0.1) 0px 0px 0px 1px,rgba(0, 0, 0, 0.2) 0px 5px 10px,rgba(0, 0, 0, 0.4) 0px 15px 40px;--theme-sizes-1:0.25rem;--theme-sizes-2:0.5rem;--theme-sizes-3:0.75rem;--theme-sizes-4:1rem;--theme-sizes-5:1.25rem;--theme-sizes-6:1.5rem;--theme-sizes-7:1.75rem;--theme-sizes-8:2rem;--theme-sizes-9:2.25rem;--theme-sizes-10:2.5rem;--theme-sizes-12:3rem;--theme-sizes-14:3.5rem;--theme-sizes-16:4rem;--theme-sizes-20:5rem;--theme-sizes-24:6rem;--theme-sizes-28:7rem;--theme-sizes-32:8rem;--theme-sizes-36:9rem;--theme-sizes-40:10rem;--theme-sizes-44:11rem;--theme-sizes-48:12rem;--theme-sizes-52:13rem;--theme-sizes-56:14rem;--theme-sizes-60:15rem;--theme-sizes-64:16rem;--theme-sizes-72:18rem;--theme-sizes-80:20rem;--theme-sizes-96:24rem;--theme-sizes-px:1px;--theme-sizes-0\.5:0.125rem;--theme-sizes-1\.5:0.375rem;--theme-sizes-2\.5:0.625rem;--theme-sizes-3\.5:0.875rem;--theme-sizes-max:max-content;--theme-sizes-min:min-content;--theme-sizes-full:100%;--theme-sizes-3xs:14rem;--theme-sizes-2xs:16rem;--theme-sizes-xs:20rem;--theme-sizes-sm:24rem;--theme-sizes-md:28rem;--theme-sizes-lg:32rem;--theme-sizes-xl:36rem;--theme-sizes-2xl:42rem;--theme-sizes-3xl:48rem;--theme-sizes-4xl:56rem;--theme-sizes-5xl:64rem;--theme-sizes-6xl:72rem;--theme-sizes-7xl:80rem;--theme-sizes-8xl:90rem;--theme-sizes-container-sm:640px;--theme-sizes-container-md:768px;--theme-sizes-container-lg:1024px;--theme-sizes-container-xl:1280px;--theme-zIndices-hide:-1;--theme-zIndices-auto:auto;--theme-zIndices-base:0;--theme-zIndices-docked:10;--theme-zIndices-dropdown:1000;--theme-zIndices-sticky:1100;--theme-zIndices-banner:1200;--theme-zIndices-overlay:1300;--theme-zIndices-modal:1400;--theme-zIndices-popover:1500;--theme-zIndices-skipLink:1600;--theme-zIndices-toast:1700;--theme-zIndices-tooltip:1800;--theme-transition-property-common:background-color,border-color,color,fill,stroke,opacity,box-shadow,transform;--theme-transition-property-colors:background-color,border-color,color,fill,stroke;--theme-transition-property-dimensions:width,height;--theme-transition-property-position:left,right,top,bottom;--theme-transition-property-background:background-color,background-image,background-position;--theme-transition-easing-ease-in:cubic-bezier(0.4, 0, 1, 1);--theme-transition-easing-ease-out:cubic-bezier(0, 0, 0.2, 1);--theme-transition-easing-ease-in-out:cubic-bezier(0.4, 0, 0.2, 1);--theme-transition-duration-ultra-fast:50ms;--theme-transition-duration-faster:100ms;--theme-transition-duration-fast:150ms;--theme-transition-duration-normal:200ms;--theme-transition-duration-slow:300ms;--theme-transition-duration-slower:400ms;--theme-transition-duration-ultra-slow:500ms;--theme-blur-none:0;--theme-blur-sm:4px;--theme-blur-base:8px;--theme-blur-md:12px;--theme-blur-lg:16px;--theme-blur-xl:24px;--theme-blur-2xl:40px;--theme-blur-3xl:64px;}</style><style data-emotion="css-global dz2wpu">body{font-family:var(--theme-fonts-body);color:var(--theme-colors-whiteAlpha-900);background:var(--theme-colors-gray-800);transition-property:background-color;transition-duration:var(--theme-transition-duration-normal);line-height:var(--theme-lineHeights-base);margin:0px;}*::-webkit-input-placeholder{color:var(--theme-colors-whiteAlpha-400);}*::-moz-placeholder{color:var(--theme-colors-whiteAlpha-400);}*:-ms-input-placeholder{color:var(--theme-colors-whiteAlpha-400);}*::placeholder{color:var(--theme-colors-whiteAlpha-400);}*,*::before,::after{border-color:var(--theme-colors-whiteAlpha-300);word-wrap:break-word;}*,*::before,::after{border-width:0;border-style:solid;box-sizing:border-box;}html{line-height:1.5;-webkit-text-size-adjust:100%;font-family:system-ui,sans-serif;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;-moz-osx-font-smoothing:grayscale;touch-action:manipulation;}a{-webkit-text-decoration:inherit;text-decoration:inherit;background-color:var(--theme-colors-transparent);}button{line-height:inherit;background-color:var(--theme-colors-transparent);}button,input,optgroup,select,textarea{padding:0px;line-height:inherit;color:inherit;font-family:inherit;font-size:100%;margin:0px;}button,[role="button"]{cursor:pointer;}</style><style data-emotion="css 1b7aqiv">.css-1b7aqiv{top:0px;width:100%;position:-webkit-sticky;position:sticky;z-index:1;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);padding:0.5rem;height:3.5rem;}</style><header class="css-1b7aqiv"><style data-emotion="css h9lgx4">.css-h9lgx4{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;width:100%;}.css-h9lgx4>*:not(style)~*:not(style){-webkit-margin-start:0.5rem;margin-inline-start:0.5rem;}</style><nav role="group" class="chakra-button__group css-h9lgx4"><style data-emotion="css 1qiejm4">.css-1qiejm4{margin:auto;padding:0 0.5em;}</style><span class="css-1qiejm4"><style data-emotion="css 1eeshli">.css-1eeshli{transition-property:var(--theme-transition-property-common);transition-duration:var(--theme-transition-duration-fast);transition-timing-function:var(--theme-transition-easing-ease-out);cursor:pointer;-webkit-text-decoration:none;text-decoration:none;outline:2px solid transparent;outline-offset:2px;color:inherit;display:block;}.css-1eeshli:hover,.css-1eeshli[data-hover]{-webkit-text-decoration:none;text-decoration:none;}.css-1eeshli:focus,.css-1eeshli[data-focus]{-webkit-text-decoration:none;text-decoration:none;}.css-1eeshli:active,.css-1eeshli[data-active]{-webkit-text-decoration:none;text-decoration:none;}</style><a class="chakra-link css-1eeshli" href="/"><style data-emotion="css 1wzypky">.css-1wzypky{width:40px;height:40px;display:block;}</style><img alt="Home Page Icon" src="/favicon.ico" class="chakra-image css-1wzypky"/></a></span><style data-emotion="css ozv6cb">.css-ozv6cb{display:none;}@media screen and (min-width: 48em){.css-ozv6cb{display:block;}}</style><div class="css-ozv6cb"><style data-emotion="css hr9oie">.css-hr9oie{transition-property:var(--theme-transition-property-common);transition-duration:var(--theme-transition-duration-fast);transition-timing-function:var(--theme-transition-easing-ease-out);cursor:pointer;-webkit-text-decoration:none;text-decoration:none;outline:2px solid transparent;outline-offset:2px;color:inherit;}.css-hr9oie:hover,.css-hr9oie[data-hover]{-webkit-text-decoration:underline;text-decoration:underline;}.css-hr9oie:focus,.css-hr9oie[data-focus]{box-shadow:var(--theme-shadows-outline);-webkit-text-decoration:underline;text-decoration:underline;}.css-hr9oie:active,.css-hr9oie[data-active]{-webkit-text-decoration:underline;text-decoration:underline;}</style><a class="chakra-link css-hr9oie" href="/about/"><style data-emotion="css 8tinun">.css-8tinun{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;appearance:none;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:relative;white-space:nowrap;vertical-align:middle;outline:2px solid transparent;outline-offset:2px;width:auto;line-height:1.2;border-radius:var(--theme-radii-md);font-weight:var(--theme-fontWeights-semibold);transition-property:var(--theme-transition-property-common);transition-duration:var(--theme-transition-duration-normal);height:var(--theme-sizes-10);min-width:var(--theme-sizes-10);font-size:var(--theme-fontSizes-md);-webkit-padding-start:var(--theme-space-4);padding-inline-start:var(--theme-space-4);-webkit-padding-end:var(--theme-space-4);padding-inline-end:var(--theme-space-4);background:var(--theme-colors-whatsapp-200);color:var(--theme-colors-gray-800);padding:0.5rem 1rem;margin-right:0.5rem;}.css-8tinun:focus,.css-8tinun[data-focus]{box-shadow:var(--theme-shadows-outline);z-index:1;}.css-8tinun[disabled],.css-8tinun[aria-disabled=true],.css-8tinun[data-disabled]{opacity:0.4;cursor:not-allowed;box-shadow:var(--theme-shadows-none);}.css-8tinun:hover,.css-8tinun[data-hover]{background:var(--theme-colors-whatsapp-300);}.css-8tinun:hover[disabled],.css-8tinun[data-hover][disabled],.css-8tinun:hover[aria-disabled=true],.css-8tinun[data-hover][aria-disabled=true],.css-8tinun:hover[data-disabled],.css-8tinun[data-hover][data-disabled]{background:var(--theme-colors-whatsapp-200);}.css-8tinun:active,.css-8tinun[data-active]{background:var(--theme-colors-whatsapp-400);}</style><button type="button" class="chakra-button css-8tinun" aria-label="About">About</button></a><a class="chakra-link css-hr9oie" href="/blog/"><button type="button" class="chakra-button css-8tinun" aria-label="Blog">Blog</button></a></div><style data-emotion="css 17xejub">.css-17xejub{-webkit-flex:1;-ms-flex:1;flex:1;justify-self:stretch;-webkit-align-self:stretch;-ms-flex-item-align:stretch;align-self:stretch;}</style><div class="css-17xejub"></div><style data-emotion="css 1m8mo83">.css-1m8mo83{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;appearance:none;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:relative;white-space:nowrap;vertical-align:middle;outline:2px solid transparent;outline-offset:2px;width:auto;line-height:1.2;border-radius:var(--theme-radii-md);font-weight:var(--theme-fontWeights-semibold);transition-property:var(--theme-transition-property-common);transition-duration:var(--theme-transition-duration-normal);height:var(--theme-sizes-10);min-width:var(--theme-sizes-10);font-size:var(--theme-fontSizes-md);-webkit-padding-start:var(--theme-space-4);padding-inline-start:var(--theme-space-4);-webkit-padding-end:var(--theme-space-4);padding-inline-end:var(--theme-space-4);background:var(--theme-colors-whatsapp-200);color:var(--theme-colors-gray-800);padding:0px;}.css-1m8mo83:focus,.css-1m8mo83[data-focus]{box-shadow:var(--theme-shadows-outline);z-index:1;}.css-1m8mo83[disabled],.css-1m8mo83[aria-disabled=true],.css-1m8mo83[data-disabled]{opacity:0.4;cursor:not-allowed;box-shadow:var(--theme-shadows-none);}.css-1m8mo83:hover,.css-1m8mo83[data-hover]{background:var(--theme-colors-whatsapp-300);}.css-1m8mo83:hover[disabled],.css-1m8mo83[data-hover][disabled],.css-1m8mo83:hover[aria-disabled=true],.css-1m8mo83[data-hover][aria-disabled=true],.css-1m8mo83:hover[data-disabled],.css-1m8mo83[data-hover][data-disabled]{background:var(--theme-colors-whatsapp-200);}.css-1m8mo83:active,.css-1m8mo83[data-active]{background:var(--theme-colors-whatsapp-400);}</style><button type="button" class="chakra-button css-1m8mo83" aria-label="Toggle theme"><style data-emotion="css 6tplt8">.css-6tplt8{width:1.25em;height:1.25em;display:inline-block;line-height:1em;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;color:currentColor;vertical-align:middle;}</style><svg viewBox="0 0 24 24" focusable="false" class="chakra-icon css-6tplt8" aria-hidden="true"><g stroke-linejoin="round" stroke-linecap="round" stroke-width="2" fill="none" stroke="currentColor"><circle cx="12" cy="12" r="5"></circle><path d="M12 1v2"></path><path d="M12 21v2"></path><path d="M4.22 4.22l1.42 1.42"></path><path d="M18.36 18.36l1.42 1.42"></path><path d="M1 12h2"></path><path d="M21 12h2"></path><path d="M4.22 19.78l1.42-1.42"></path><path d="M18.36 5.64l1.42-1.42"></path></g></svg></button><style data-emotion="css r3x2q9">@media screen and (min-width: 48em){.css-r3x2q9{display:none;}}</style><div class="css-r3x2q9"><button type="button" class="chakra-button chakra-menu__menu-button css-1m8mo83" aria-label="Navigation Menu" id="menu-button-2" aria-expanded="false" aria-haspopup="menu" aria-controls="menu-list-2"><style data-emotion="css onkibi">.css-onkibi{width:1em;height:1em;display:inline-block;line-height:1em;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;color:currentColor;vertical-align:middle;}</style><svg viewBox="0 0 24 24" focusable="false" class="chakra-icon css-onkibi" aria-hidden="true"><path fill="currentColor" d="M 3 5 A 1.0001 1.0001 0 1 0 3 7 L 21 7 A 1.0001 1.0001 0 1 0 21 5 L 3 5 z M 3 11 A 1.0001 1.0001 0 1 0 3 13 L 21 13 A 1.0001 1.0001 0 1 0 21 11 L 3 11 z M 3 17 A 1.0001 1.0001 0 1 0 3 19 L 21 19 A 1.0001 1.0001 0 1 0 21 17 L 3 17 z"></path></svg></button><style data-emotion="css r6z5ec">.css-r6z5ec{z-index:1;}</style><div style="visibility:hidden;position:absolute;min-width:max-content;inset:0 auto auto 0" class="css-r6z5ec"><style data-emotion="css uul3r9">.css-uul3r9{outline:2px solid transparent;outline-offset:2px;background:var(--theme-colors-gray-700);box-shadow:var(--theme-shadows-dark-lg);color:inherit;min-width:var(--theme-sizes-3xs);padding-top:var(--theme-space-2);padding-bottom:var(--theme-space-2);z-index:1;border-radius:var(--theme-radii-md);border-width:1px;}</style><div tabindex="-1" role="menu" id="menu-list-2" style="transform-origin:var(--popper-transform-origin);opacity:0;visibility:hidden;transform:scale(0.8) translateZ(0)" aria-orientation="vertical" class="chakra-menu__menu-list css-uul3r9"></div></div></div></nav></header><style data-emotion="css 9shr38">.css-9shr38{min-height:calc(100vh - 3.5rem - 2rem -  4 * 0.5rem);padding:0.5rem;}</style><main class="css-9shr38"><div style="overflow-y:hidden;opacity:0;max-height:calc(100vh - 3.5rem - 2rem -  4 * 0.5rem + 2 *  0.5rem + 2rem - 25px);transform:translateY(25px) translateZ(0)"><style data-emotion="css 1rudzk8">.css-1rudzk8{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;min-height:calc(100vh - 3.5rem - 2rem -  4 * 0.5rem);-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-flex:1;-ms-flex:1;flex:1;padding:1rem;text-align:center;}</style><section class="css-1rudzk8"><style data-emotion="css 9c1kzp">.css-9c1kzp{width:100%;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;max-width:var(--theme-sizes-container-lg);-webkit-padding-start:1rem;padding-inline-start:1rem;-webkit-padding-end:1rem;padding-inline-end:1rem;text-align:start;}</style><article class="chakra-container css-9c1kzp"><style data-emotion="css 14lttl">.css-14lttl{font-family:var(--theme-fonts-heading);font-weight:var(--theme-fontWeights-bold);margin:0.83rem 0;font-size:var(--theme-fontSizes-4xl);line-height:1.2;margin-bottom:0px;}@media screen and (min-width: 48em){.css-14lttl{font-size:var(--theme-fontSizes-5xl);line-height:1;}}</style><h1 class="chakra-heading css-14lttl">Refactor Hell</h1><style data-emotion="css 70qvj9">.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="css-70qvj9"><style data-emotion="css x2rzbw">.css-x2rzbw{font-family:var(--theme-fonts-heading);font-weight:var(--theme-fontWeights-bold);margin:0px;font-size:var(--theme-fontSizes-md);line-height:1.2;margin-bottom:0.8em;}</style><h2 class="chakra-heading css-x2rzbw">by <!-- -->Zyrn</h2><style data-emotion="css 17xejub">.css-17xejub{-webkit-flex:1;-ms-flex:1;flex:1;justify-self:stretch;-webkit-align-self:stretch;-ms-flex-item-align:stretch;align-self:stretch;}</style><div class="css-17xejub"></div><style data-emotion="css 38r7s4">.css-38r7s4{font-family:var(--theme-fonts-heading);font-weight:var(--theme-fontWeights-bold);margin:0px;font-size:var(--theme-fontSizes-md);line-height:1.2;margin-bottom:0.8em;color:var(--theme-colors-green-600);}</style><time class="chakra-heading css-38r7s4" dateTime="2021-03-16T00:00:00.000Z">2021-03-16</time></div><div class="css-0"><p>Once again, this month I revisited an old project and improved it. This project was the notifications app I developed in November last year, which I discussed at the time in <a href="/blog/a-fluttering-experience" title="November 2020 Flutter Notification App">this article</a>.</p>
<p>The largest change on all was a complete overhaul of the backend architecture, which was centered around the change for a singular <a href="https://www.sqlite.org/" title="SQLite">SQLite</a> database on deployed server to using Google Firebase's <a href="https://firebase.google.com/products/firestore" title="Google Cloud Firestore">Firestore</a>, offering a host of benefits such as:</p>
<ul>
<li>Cloud Data Redundancy</li>
<li>Security (SQL injection style vulnerabilities)</li>
<li>Scalability</li>
<li>Increase Maintainability (no need for a RESTful API)</li>
</ul>
<p>This change in database and also <a href="https://en.wikipedia.org/wiki/Database_model" title="Database Paradigms">database paradigm</a>, also resulted in a much more manageable code base as I switched from a loose imperative coding style to an object oriented design which more closely matched the document style database.
This meant there were a lot less confusing and poorly design bits of code as there was a clear data model of which the class models could imitate.</p>
<p>The removal of the RESTful API was particularly nice as it was poorly structured, using no extra layers of abstraction from the minimalistic design of <a href="https://expressjs.com/" title="Express.js">Express.js</a>.
One example of this poor code quality was the heavy use of try-catches around a single line of code or using await without any error handling.</p>
<h3>An example of poor asynchronous code and error handling</h3>
<div class="remark-highlight"><pre class="language-js"><code class="language-js"><span class="token comment">// routes/topic.js (API endpoint for handling subscriptions to topics)</span>
router<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>   
<span class="token keyword control-flow">try</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token keyword control-flow">await</span> db<span class="token punctuation">.</span><span class="token method function property-access">getMemberGroups</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword control-flow">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token string">"Internal Server Error: "</span> <span class="token operator">+</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword control-flow">await</span> db<span class="token punctuation">.</span><span class="token method function property-access">unsubscribeFromGroup</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span> topic<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword control-flow">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<h3>An example of event based programming, which is not subject to some errors which async / await introduced.</h3>
<div class="remark-highlight"><pre class="language-js"><code class="language-js"><span class="token comment">// lib/Jobs.js (controller for issusing notifications)</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">ref</span><span class="token punctuation">.</span><span class="token method function property-access">onSnapshot</span><span class="token punctuation">(</span><span class="token parameter">querySnapshot</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    querySnapshot<span class="token punctuation">.</span><span class="token method function property-access">docChanges</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">forEach</span><span class="token punctuation">(</span><span class="token parameter">change</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
        <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>change<span class="token punctuation">.</span><span class="token property-access">type</span> <span class="token operator">===</span> <span class="token string">'added'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">jobs</span><span class="token punctuation">.</span><span class="token method function property-access">set</span><span class="token punctuation">(</span>change<span class="token punctuation">.</span><span class="token property-access">doc</span><span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> data<span class="token operator">:</span> change<span class="token punctuation">.</span><span class="token property-access">doc</span><span class="token punctuation">.</span><span class="token method function property-access">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>change<span class="token punctuation">.</span><span class="token property-access">doc</span><span class="token punctuation">.</span><span class="token method function property-access">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">isSubscribed</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token method function property-access">registerJob</span><span class="token punctuation">(</span>change<span class="token punctuation">.</span><span class="token property-access">doc</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>change<span class="token punctuation">.</span><span class="token property-access">type</span> <span class="token operator">===</span> <span class="token string">'modified'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">jobs</span><span class="token punctuation">.</span><span class="token method function property-access">set</span><span class="token punctuation">(</span>change<span class="token punctuation">.</span><span class="token property-access">doc</span><span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">,</span> change<span class="token punctuation">.</span><span class="token property-access">doc</span><span class="token punctuation">.</span><span class="token method function property-access">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>change<span class="token punctuation">.</span><span class="token property-access">doc</span><span class="token punctuation">.</span><span class="token method function property-access">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">isSubscribed</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token method function property-access">registerJob</span><span class="token punctuation">(</span>change<span class="token punctuation">.</span><span class="token property-access">doc</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token method function property-access">deregisterJob</span><span class="token punctuation">(</span>change<span class="token punctuation">.</span><span class="token property-access">doc</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>change<span class="token punctuation">.</span><span class="token property-access">type</span> <span class="token operator">===</span> <span class="token string">'removed'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">jobs</span><span class="token punctuation">.</span><span class="token method function property-access">delete</span><span class="token punctuation">(</span>change<span class="token punctuation">.</span><span class="token property-access">doc</span><span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token method function property-access">deregisterJob</span><span class="token punctuation">(</span>change<span class="token punctuation">.</span><span class="token property-access">doc</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>As a result of this change on database, I also upgraded the security of the authentication within the system, moving from manually issues API tokens, to more secure, flexible, and accessible tokens issued using <a href="https://firebase.google.com/products/auth" title="Google Firebase Authentication">Google Firebase Auth</a>.</p>
<p>These major changes in the backend, meant the frontend needed a significant re-write. I used this opportunity to upgrade to <a href="https://developers.googleblog.com/2021/03/announcing-flutter-2.html" title="Flutter 2 Announcement">Flutter 2</a>, using <a href="https://flutter.dev/docs/null-safety" title="Null Safety">null safety</a>.</p>
</div></article></section><style data-emotion="css 74z0cz">.css-74z0cz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;width:100%;padding:0.5rem;height:2rem;}</style><footer class="css-74z0cz">made with <style data-emotion="css t1cdlx">.css-t1cdlx{color:var(--theme-colors-dark-red);padding:0 0.2rem;}</style><span class="chakra-text css-t1cdlx">‚ù§</span> by zyrn</footer></div></main><span></span></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"filename":"refactor-hell","title":"Refactor Hell","date":"2021-03-16","author":"Zyrn","published":true,"content":"\u003cp\u003eOnce again, this month I revisited an old project and improved it. This project was the notifications app I developed in November last year, which I discussed at the time in \u003ca href=\"/blog/a-fluttering-experience\" title=\"November 2020 Flutter Notification App\"\u003ethis article\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eThe largest change on all was a complete overhaul of the backend architecture, which was centered around the change for a singular \u003ca href=\"https://www.sqlite.org/\" title=\"SQLite\"\u003eSQLite\u003c/a\u003e database on deployed server to using Google Firebase's \u003ca href=\"https://firebase.google.com/products/firestore\" title=\"Google Cloud Firestore\"\u003eFirestore\u003c/a\u003e, offering a host of benefits such as:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eCloud Data Redundancy\u003c/li\u003e\n\u003cli\u003eSecurity (SQL injection style vulnerabilities)\u003c/li\u003e\n\u003cli\u003eScalability\u003c/li\u003e\n\u003cli\u003eIncrease Maintainability (no need for a RESTful API)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThis change in database and also \u003ca href=\"https://en.wikipedia.org/wiki/Database_model\" title=\"Database Paradigms\"\u003edatabase paradigm\u003c/a\u003e, also resulted in a much more manageable code base as I switched from a loose imperative coding style to an object oriented design which more closely matched the document style database.\nThis meant there were a lot less confusing and poorly design bits of code as there was a clear data model of which the class models could imitate.\u003c/p\u003e\n\u003cp\u003eThe removal of the RESTful API was particularly nice as it was poorly structured, using no extra layers of abstraction from the minimalistic design of \u003ca href=\"https://expressjs.com/\" title=\"Express.js\"\u003eExpress.js\u003c/a\u003e.\nOne example of this poor code quality was the heavy use of try-catches around a single line of code or using await without any error handling.\u003c/p\u003e\n\u003ch3\u003eAn example of poor asynchronous code and error handling\u003c/h3\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token comment\"\u003e// routes/topic.js (API endpoint for handling subscriptions to topics)\u003c/span\u003e\nrouter\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eget\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'/'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ereq\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e res\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e   \n\u003cspan class=\"token keyword control-flow\"\u003etry\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    res\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ejson\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword control-flow\"\u003eawait\u003c/span\u003e db\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003egetMemberGroups\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ecatch\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eerr\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eerr\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    res\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003estatus\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e500\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esend\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Internal Server Error: \"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e err\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword control-flow\"\u003eawait\u003c/span\u003e db\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eunsubscribeFromGroup\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003etoken\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e topic\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token keyword control-flow\"\u003ecatch\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eerr\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3\u003eAn example of event based programming, which is not subject to some errors which async / await introduced.\u003c/h3\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token comment\"\u003e// lib/Jobs.js (controller for issusing notifications)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eref\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eonSnapshot\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003equerySnapshot\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    querySnapshot\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003edocChanges\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eforEach\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003echange\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003echange\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003etype\u003c/span\u003e \u003cspan class=\"token operator\"\u003e===\u003c/span\u003e \u003cspan class=\"token string\"\u003e'added'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ejobs\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eset\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003echange\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edoc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eid\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e data\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e change\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edoc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003edata\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003echange\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edoc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003edata\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eisSubscribed\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eregisterJob\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003echange\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edoc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003echange\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003etype\u003c/span\u003e \u003cspan class=\"token operator\"\u003e===\u003c/span\u003e \u003cspan class=\"token string\"\u003e'modified'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ejobs\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eset\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003echange\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edoc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eid\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e change\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edoc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003edata\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003echange\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edoc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003edata\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eisSubscribed\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eregisterJob\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003echange\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edoc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003eelse\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ederegisterJob\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003echange\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edoc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003echange\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003etype\u003c/span\u003e \u003cspan class=\"token operator\"\u003e===\u003c/span\u003e \u003cspan class=\"token string\"\u003e'removed'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ejobs\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003edelete\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003echange\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edoc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eid\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ederegisterJob\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003echange\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edoc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAs a result of this change on database, I also upgraded the security of the authentication within the system, moving from manually issues API tokens, to more secure, flexible, and accessible tokens issued using \u003ca href=\"https://firebase.google.com/products/auth\" title=\"Google Firebase Authentication\"\u003eGoogle Firebase Auth\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eThese major changes in the backend, meant the frontend needed a significant re-write. I used this opportunity to upgrade to \u003ca href=\"https://developers.googleblog.com/2021/03/announcing-flutter-2.html\" title=\"Flutter 2 Announcement\"\u003eFlutter 2\u003c/a\u003e, using \u003ca href=\"https://flutter.dev/docs/null-safety\" title=\"Null Safety\"\u003enull safety\u003c/a\u003e.\u003c/p\u003e\n"},"__N_SSG":true},"page":"/blog/[filename]","query":{"filename":"refactor-hell"},"buildId":"ivrcb-DN-mBRoThUjEOaE","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>